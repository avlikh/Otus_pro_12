# OTUS PRO Homework 12-Systemd

### Домашняя работа 12: Инициализация системы. Systemd (реализована на Debian 12)
---
### Домашнее задание:
   - Написать service, который будет раз в 30 секунд мониторить лог на предмет наличия ключевого слова (файл лога и ключевое слово должны задаваться в /etc/default).  
   - Установить spawn-fcgi и создать unit-файл (spawn-fcgi.sevice) с помощью переделки init-скрипта (https://gist.github.com/cea2k/1318020).  
   - Доработать unit-файл Nginx (nginx.service) для запуска нескольких инстансов сервера с разными конфигурационными файлами одновременно.
---
### Выполнение задания:

### Зайдите на OS, где установлен Ansible с root доступом
   - Примечание: используйте пользователя **root** либо команды: **su - root** либо **sudo -i**

### Выполните данную команду на удаленной машине:
```
apt update -y && apt install git -y ; git clone https://github.com/avlikh/Otus_pro_12.git /ansible;
```

### Внесите изменения в файл: /ansible/vars/vars_file.yml
   - имя и ip-адрес серверов, на которых будет установлена служба
   - можете изменить остальные переменные по желанию
---
#### 1) Написать service, который будет раз в 30 секунд мониторить лог на предмет наличия ключевого слова (файл лога и ключевое слово должны задаваться в /etc/default).

### 1) Выполните данную команду на удаленной машине. Будет запущен playbook:
```
cd /ansible/ && ansible-playbook unit_monitoring.yml -u root --ask-pass
```
- Вам потребуется ввести пароль пользователя root для подключения Ansible к удаленной машине 
<details>
<summary>проверить работу сервиса</summary>
- Что бы проверить работу сервиса, необходимо выполнить следующую команду на целевой машине:

```
journalctl -n 20 -u watchlog.service
```
</details>

---
 #### 2) Установить spawn-fcgi и создать unit-файл (spawn-fcgi.sevice) с помощью переделки init-скрипта (https://gist.github.com/cea2k/1318020)
### 2) Выполните данную команду на удаленной машине. Будет запущен playbook: 
```
cd /ansible/ && ansible-playbook unit_spawn.yml -u root --ask-pass
```
- Вам потребуется ввести пароль пользователя root для подключения Ansible к удаленной машине 
<details>
<summary>проверить работу сервиса</summary>
- Что бы проверить работу сервиса, необходимо выполнить следующую команду на целевой машине:

```
systemctl status spawn-fcgi
```
</details>

---
#### 3) Доработать unit-файл Nginx (nginx.service) для запуска нескольких инстансов сервера с разными конфигурационными файлами одновременно
### 3) Выполните данную команду на удаленной машине. Будет запущен playbook:
```
cd /ansible/ && ansible-playbook unit_nginx.yml -u root --ask-pass
```
- Вам потребуется ввести пароль пользователя root для подключения Ansible к удаленной машине 

<details>
<summary>проверить работу сервиса</summary>
- Что бы проверить работу сервиса, необходимо выполнить следующую команду на целевой машине:

```
systemctl status nginx@first
systemctl status nginx@second
```
</details>